<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="null">
	<resultMap id="ResultMap" type="com.yunyi.order.po.Order">
		<id column="order_id" jdbcType="BIGINT" property="orderId" />
		<result column="is_parent" jdbcType="BIT" property="isParent" />
		<result column="order_parent_id" jdbcType="BIGINT" property="orderParentId" />
		<result column="order_no" jdbcType="VARCHAR" property="orderNo" />
		<result column="order_type" jdbcType="INT" property="orderType" />
		<result column="order_status_code" jdbcType="INT" property="orderStatusCode" />
		<result column="channel_id" jdbcType="INT" property="channelId" />
		<result column="channel_name" jdbcType="VARCHAR" property="channelName" />
		<result column="channel_order_no" jdbcType="VARCHAR" property="channelOrderNo" />
		<result column="supplier_id" jdbcType="INT" property="supplierId" />
		<result column="supplier_order_no" jdbcType="VARCHAR" property="supplierOrderNo" />
		<result column="submit_state" jdbcType="BIT" property="submitState" />
		<result column="order_amount" jdbcType="DECIMAL" property="orderAmount" />
		<result column="order_pay_amount" jdbcType="DECIMAL" property="orderPayAmount" />
		<result column="order_actul_pay_amount" jdbcType="DECIMAL" property="orderActulPayAmount" />
		<result column="order_time" jdbcType="DATETIME" property="orderTime" />
		<result column="assign_time" jdbcType="DATETIME" property="assignTime" />
		<result column="deliver_time" jdbcType="DATETIME" property="deliverTime" />
		<result column="pay_time" jdbcType="DATETIME" property="payTime" />
		<result column="confirm_time" jdbcType="DATETIME" property="confirmTime" />
		<result column="deliver_no_list" jdbcType="VARCHAR" property="deliverNoList" />
		<result column="deliver_name_list" jdbcType="VARCHAR" property="deliverNameList" />
		<result column="is_close_calc" jdbcType="BIT" property="isCloseCalc" />
		<result column="order_remark" jdbcType="VARCHAR" property="orderRemark" />
		<result column="is_delate" jdbcType="BIT" property="isDelate" />
		<result column="create_time" jdbcType="DATETIME" property="createTime" />
		<result column="creator" jdbcType="VARCHAR" property="creator" />
		<result column="last_update_time" jdbcType="DATETIME" property="lastUpdateTime" />
		<result column="last_updator" jdbcType="VARCHAR" property="lastUpdator" />
	</resultMap>

	<!-- 可能更改的字段, 给通用方法使用 -->
	<sql id="UpdateSetColumns">
		<set>
			<if test="orderId != null"> order_id = #{orderId, jdbcType=BIGINT},</if>
			<if test="isParent != null"> is_parent = #{isParent, jdbcType=BIT},</if>
			<if test="orderParentId != null"> order_parent_id = #{orderParentId, jdbcType=BIGINT},</if>
			<if test="orderNo != null"> order_no = #{orderNo, jdbcType=VARCHAR},</if>
			<if test="orderType != null"> order_type = #{orderType, jdbcType=INT},</if>
			<if test="orderStatusCode != null"> order_status_code = #{orderStatusCode, jdbcType=INT},</if>
			<if test="channelId != null"> channel_id = #{channelId, jdbcType=INT},</if>
			<if test="channelName != null"> channel_name = #{channelName, jdbcType=VARCHAR},</if>
			<if test="channelOrderNo != null"> channel_order_no = #{channelOrderNo, jdbcType=VARCHAR},</if>
			<if test="supplierId != null"> supplier_id = #{supplierId, jdbcType=INT},</if>
			<if test="supplierOrderNo != null"> supplier_order_no = #{supplierOrderNo, jdbcType=VARCHAR},</if>
			<if test="submitState != null"> submit_state = #{submitState, jdbcType=BIT},</if>
			<if test="orderAmount != null"> order_amount = #{orderAmount, jdbcType=DECIMAL},</if>
			<if test="orderPayAmount != null"> order_pay_amount = #{orderPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderActulPayAmount != null"> order_actul_pay_amount = #{orderActulPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderTime != null"> order_time = #{orderTime, jdbcType=DATETIME},</if>
			<if test="assignTime != null"> assign_time = #{assignTime, jdbcType=DATETIME},</if>
			<if test="deliverTime != null"> deliver_time = #{deliverTime, jdbcType=DATETIME},</if>
			<if test="payTime != null"> pay_time = #{payTime, jdbcType=DATETIME},</if>
			<if test="confirmTime != null"> confirm_time = #{confirmTime, jdbcType=DATETIME},</if>
			<if test="deliverNoList != null"> deliver_no_list = #{deliverNoList, jdbcType=VARCHAR},</if>
			<if test="deliverNameList != null"> deliver_name_list = #{deliverNameList, jdbcType=VARCHAR},</if>
			<if test="isCloseCalc != null"> is_close_calc = #{isCloseCalc, jdbcType=BIT},</if>
			<if test="orderRemark != null"> order_remark = #{orderRemark, jdbcType=VARCHAR},</if>
			<if test="isDelate != null"> is_delate = #{isDelate, jdbcType=BIT},</if>
			<if test="createTime != null"> create_time = #{createTime, jdbcType=DATETIME},</if>
			<if test="creator != null"> creator = #{creator, jdbcType=VARCHAR},</if>
			<if test="lastUpdateTime != null"> last_update_time = #{lastUpdateTime, jdbcType=DATETIME},</if>
			<if test="lastUpdator != null"> last_updator = #{lastUpdator, jdbcType=VARCHAR},</if>
		<set/>
	</resultMap>

	<!-- 插入数据-单条 -->
	<insert id="insertOrder" useGeneratedKey="true" keyProperty="orderId" parameterType="com.yunyi.order.po.Order">
		insert into dt_order (
			<if test="orderId != null"> order_id, </if>
			<if test="isParent != null"> is_parent, </if>
			<if test="orderParentId != null"> order_parent_id, </if>
			<if test="orderNo != null"> order_no, </if>
			<if test="orderType != null"> order_type, </if>
			<if test="orderStatusCode != null"> order_status_code, </if>
			<if test="channelId != null"> channel_id, </if>
			<if test="channelName != null"> channel_name, </if>
			<if test="channelOrderNo != null"> channel_order_no, </if>
			<if test="supplierId != null"> supplier_id, </if>
			<if test="supplierOrderNo != null"> supplier_order_no, </if>
			<if test="submitState != null"> submit_state, </if>
			<if test="orderAmount != null"> order_amount, </if>
			<if test="orderPayAmount != null"> order_pay_amount, </if>
			<if test="orderActulPayAmount != null"> order_actul_pay_amount, </if>
			<if test="orderTime != null"> order_time, </if>
			<if test="assignTime != null"> assign_time, </if>
			<if test="deliverTime != null"> deliver_time, </if>
			<if test="payTime != null"> pay_time, </if>
			<if test="confirmTime != null"> confirm_time, </if>
			<if test="deliverNoList != null"> deliver_no_list, </if>
			<if test="deliverNameList != null"> deliver_name_list, </if>
			<if test="isCloseCalc != null"> is_close_calc, </if>
			<if test="orderRemark != null"> order_remark, </if>
			<if test="isDelate != null"> is_delate, </if>
			<if test="createTime != null"> create_time, </if>
			<if test="creator != null"> creator, </if>
			<if test="lastUpdateTime != null"> last_update_time, </if>
			<if test="lastUpdator != null"> last_updator, </if>
		)values(
			<if test="orderId != null">  #{orderId, jdbcType=BIGINT},</if>
			<if test="isParent != null">  #{isParent, jdbcType=BIT},</if>
			<if test="orderParentId != null">  #{orderParentId, jdbcType=BIGINT},</if>
			<if test="orderNo != null">  #{orderNo, jdbcType=VARCHAR},</if>
			<if test="orderType != null">  #{orderType, jdbcType=INT},</if>
			<if test="orderStatusCode != null">  #{orderStatusCode, jdbcType=INT},</if>
			<if test="channelId != null">  #{channelId, jdbcType=INT},</if>
			<if test="channelName != null">  #{channelName, jdbcType=VARCHAR},</if>
			<if test="channelOrderNo != null">  #{channelOrderNo, jdbcType=VARCHAR},</if>
			<if test="supplierId != null">  #{supplierId, jdbcType=INT},</if>
			<if test="supplierOrderNo != null">  #{supplierOrderNo, jdbcType=VARCHAR},</if>
			<if test="submitState != null">  #{submitState, jdbcType=BIT},</if>
			<if test="orderAmount != null">  #{orderAmount, jdbcType=DECIMAL},</if>
			<if test="orderPayAmount != null">  #{orderPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderActulPayAmount != null">  #{orderActulPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderTime != null">  #{orderTime, jdbcType=DATETIME},</if>
			<if test="assignTime != null">  #{assignTime, jdbcType=DATETIME},</if>
			<if test="deliverTime != null">  #{deliverTime, jdbcType=DATETIME},</if>
			<if test="payTime != null">  #{payTime, jdbcType=DATETIME},</if>
			<if test="confirmTime != null">  #{confirmTime, jdbcType=DATETIME},</if>
			<if test="deliverNoList != null">  #{deliverNoList, jdbcType=VARCHAR},</if>
			<if test="deliverNameList != null">  #{deliverNameList, jdbcType=VARCHAR},</if>
			<if test="isCloseCalc != null">  #{isCloseCalc, jdbcType=BIT},</if>
			<if test="orderRemark != null">  #{orderRemark, jdbcType=VARCHAR},</if>
			<if test="isDelate != null">  #{isDelate, jdbcType=BIT},</if>
			<if test="createTime != null">  #{createTime, jdbcType=DATETIME},</if>
			<if test="creator != null">  #{creator, jdbcType=VARCHAR},</if>
			<if test="lastUpdateTime != null">  #{lastUpdateTime, jdbcType=DATETIME},</if>
			<if test="lastUpdator != null">  #{lastUpdator, jdbcType=VARCHAR},</if>
	</insert>

	<!-- 通用查询方法 -->
	<select id="getOrder" parameterType="java.util.Map" resultMap="java.lang.Integer">
		SELECT
			order_id
			,is_parent
			,order_parent_id
			,order_no
			,order_type
			,order_status_code
			,channel_id
			,channel_name
			,channel_order_no
			,supplier_id
			,supplier_order_no
			,submit_state
			,order_amount
			,order_pay_amount
			,order_actul_pay_amount
			,order_time
			,assign_time
			,deliver_time
			,pay_time
			,confirm_time
			,deliver_no_list
			,deliver_name_list
			,is_close_calc
			,order_remark
			,is_delate
			,create_time
			,creator
			,last_update_time
			,last_updator
		 FROM dt_order
		 WHERE 1=1
			<if test="isParent != null"> AND is_parent = #{isParent, jdbcType=BIT},</if>
			<if test="orderParentId != null"> AND order_parent_id = #{orderParentId, jdbcType=BIGINT},</if>
			<if test="orderNo != null"> AND order_no = #{orderNo, jdbcType=VARCHAR},</if>
			<if test="orderType != null"> AND order_type = #{orderType, jdbcType=INT},</if>
			<if test="orderStatusCode != null"> AND order_status_code = #{orderStatusCode, jdbcType=INT},</if>
			<if test="channelId != null"> AND channel_id = #{channelId, jdbcType=INT},</if>
			<if test="channelName != null"> AND channel_name = #{channelName, jdbcType=VARCHAR},</if>
			<if test="channelOrderNo != null"> AND channel_order_no = #{channelOrderNo, jdbcType=VARCHAR},</if>
			<if test="supplierId != null"> AND supplier_id = #{supplierId, jdbcType=INT},</if>
			<if test="supplierOrderNo != null"> AND supplier_order_no = #{supplierOrderNo, jdbcType=VARCHAR},</if>
			<if test="submitState != null"> AND submit_state = #{submitState, jdbcType=BIT},</if>
			<if test="orderAmount != null"> AND order_amount = #{orderAmount, jdbcType=DECIMAL},</if>
			<if test="orderPayAmount != null"> AND order_pay_amount = #{orderPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderActulPayAmount != null"> AND order_actul_pay_amount = #{orderActulPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderTime != null"> AND order_time = #{orderTime, jdbcType=DATETIME},</if>
			<if test="assignTime != null"> AND assign_time = #{assignTime, jdbcType=DATETIME},</if>
			<if test="deliverTime != null"> AND deliver_time = #{deliverTime, jdbcType=DATETIME},</if>
			<if test="payTime != null"> AND pay_time = #{payTime, jdbcType=DATETIME},</if>
			<if test="confirmTime != null"> AND confirm_time = #{confirmTime, jdbcType=DATETIME},</if>
			<if test="deliverNoList != null"> AND deliver_no_list = #{deliverNoList, jdbcType=VARCHAR},</if>
			<if test="deliverNameList != null"> AND deliver_name_list = #{deliverNameList, jdbcType=VARCHAR},</if>
			<if test="isCloseCalc != null"> AND is_close_calc = #{isCloseCalc, jdbcType=BIT},</if>
			<if test="orderRemark != null"> AND order_remark = #{orderRemark, jdbcType=VARCHAR},</if>
			<if test="isDelate != null"> AND is_delate = #{isDelate, jdbcType=BIT},</if>
			<if test="createTime != null"> AND create_time = #{createTime, jdbcType=DATETIME},</if>
			<if test="creator != null"> AND creator = #{creator, jdbcType=VARCHAR},</if>
			<if test="lastUpdateTime != null"> AND last_update_time = #{lastUpdateTime, jdbcType=DATETIME},</if>
			<if test="lastUpdator != null"> AND last_updator = #{lastUpdator, jdbcType=VARCHAR},</if>
	</select>

	<!-- 查数量 -->
	<select id="countOrder" parameterType="java.util.Map" resultMap="java.lang.Integer">
		SELECT count(*)
		FROM dt_order
		WHERE 1=1
			<if test="orderId != null"> AND order_id = #{orderId, jdbcType=BIGINT},</if>
			<if test="isParent != null"> AND is_parent = #{isParent, jdbcType=BIT},</if>
			<if test="orderParentId != null"> AND order_parent_id = #{orderParentId, jdbcType=BIGINT},</if>
			<if test="orderNo != null"> AND order_no = #{orderNo, jdbcType=VARCHAR},</if>
			<if test="orderType != null"> AND order_type = #{orderType, jdbcType=INT},</if>
			<if test="orderStatusCode != null"> AND order_status_code = #{orderStatusCode, jdbcType=INT},</if>
			<if test="channelId != null"> AND channel_id = #{channelId, jdbcType=INT},</if>
			<if test="channelName != null"> AND channel_name = #{channelName, jdbcType=VARCHAR},</if>
			<if test="channelOrderNo != null"> AND channel_order_no = #{channelOrderNo, jdbcType=VARCHAR},</if>
			<if test="supplierId != null"> AND supplier_id = #{supplierId, jdbcType=INT},</if>
			<if test="supplierOrderNo != null"> AND supplier_order_no = #{supplierOrderNo, jdbcType=VARCHAR},</if>
			<if test="submitState != null"> AND submit_state = #{submitState, jdbcType=BIT},</if>
			<if test="orderAmount != null"> AND order_amount = #{orderAmount, jdbcType=DECIMAL},</if>
			<if test="orderPayAmount != null"> AND order_pay_amount = #{orderPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderActulPayAmount != null"> AND order_actul_pay_amount = #{orderActulPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderTime != null"> AND order_time = #{orderTime, jdbcType=DATETIME},</if>
			<if test="assignTime != null"> AND assign_time = #{assignTime, jdbcType=DATETIME},</if>
			<if test="deliverTime != null"> AND deliver_time = #{deliverTime, jdbcType=DATETIME},</if>
			<if test="payTime != null"> AND pay_time = #{payTime, jdbcType=DATETIME},</if>
			<if test="confirmTime != null"> AND confirm_time = #{confirmTime, jdbcType=DATETIME},</if>
			<if test="deliverNoList != null"> AND deliver_no_list = #{deliverNoList, jdbcType=VARCHAR},</if>
			<if test="deliverNameList != null"> AND deliver_name_list = #{deliverNameList, jdbcType=VARCHAR},</if>
			<if test="isCloseCalc != null"> AND is_close_calc = #{isCloseCalc, jdbcType=BIT},</if>
			<if test="orderRemark != null"> AND order_remark = #{orderRemark, jdbcType=VARCHAR},</if>
			<if test="isDelate != null"> AND is_delate = #{isDelate, jdbcType=BIT},</if>
			<if test="createTime != null"> AND create_time = #{createTime, jdbcType=DATETIME},</if>
			<if test="creator != null"> AND creator = #{creator, jdbcType=VARCHAR},</if>
			<if test="lastUpdateTime != null"> AND last_update_time = #{lastUpdateTime, jdbcType=DATETIME},</if>
			<if test="lastUpdator != null"> AND last_updator = #{lastUpdator, jdbcType=VARCHAR},</if>
	</select>

	<!-- 分页查询 -->
	<select id="listOrder" parameterType="java.util.Map" resultMap="java.lang.Integer">
		SELECT
			a.order_id
			,a.is_parent
			,a.order_parent_id
			,a.order_no
			,a.order_type
			,a.order_status_code
			,a.channel_id
			,a.channel_name
			,a.channel_order_no
			,a.supplier_id
			,a.supplier_order_no
			,a.submit_state
			,a.order_amount
			,a.order_pay_amount
			,a.order_actul_pay_amount
			,a.order_time
			,a.assign_time
			,a.deliver_time
			,a.pay_time
			,a.confirm_time
			,a.deliver_no_list
			,a.deliver_name_list
			,a.is_close_calc
			,a.order_remark
			,a.is_delate
			,a.create_time
			,a.creator
			,a.last_update_time
			,a.last_updator
		FROM dt_order a,
		(
		SELECT order_id from dt_order
		WHERE 1=1
			<if test="orderId != null"> AND order_id = #{orderId, jdbcType=BIGINT},</if>
			<if test="isParent != null"> AND is_parent = #{isParent, jdbcType=BIT},</if>
			<if test="orderParentId != null"> AND order_parent_id = #{orderParentId, jdbcType=BIGINT},</if>
			<if test="orderNo != null"> AND order_no = #{orderNo, jdbcType=VARCHAR},</if>
			<if test="orderType != null"> AND order_type = #{orderType, jdbcType=INT},</if>
			<if test="orderStatusCode != null"> AND order_status_code = #{orderStatusCode, jdbcType=INT},</if>
			<if test="channelId != null"> AND channel_id = #{channelId, jdbcType=INT},</if>
			<if test="channelName != null"> AND channel_name = #{channelName, jdbcType=VARCHAR},</if>
			<if test="channelOrderNo != null"> AND channel_order_no = #{channelOrderNo, jdbcType=VARCHAR},</if>
			<if test="supplierId != null"> AND supplier_id = #{supplierId, jdbcType=INT},</if>
			<if test="supplierOrderNo != null"> AND supplier_order_no = #{supplierOrderNo, jdbcType=VARCHAR},</if>
			<if test="submitState != null"> AND submit_state = #{submitState, jdbcType=BIT},</if>
			<if test="orderAmount != null"> AND order_amount = #{orderAmount, jdbcType=DECIMAL},</if>
			<if test="orderPayAmount != null"> AND order_pay_amount = #{orderPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderActulPayAmount != null"> AND order_actul_pay_amount = #{orderActulPayAmount, jdbcType=DECIMAL},</if>
			<if test="orderTime != null"> AND order_time = #{orderTime, jdbcType=DATETIME},</if>
			<if test="assignTime != null"> AND assign_time = #{assignTime, jdbcType=DATETIME},</if>
			<if test="deliverTime != null"> AND deliver_time = #{deliverTime, jdbcType=DATETIME},</if>
			<if test="payTime != null"> AND pay_time = #{payTime, jdbcType=DATETIME},</if>
			<if test="confirmTime != null"> AND confirm_time = #{confirmTime, jdbcType=DATETIME},</if>
			<if test="deliverNoList != null"> AND deliver_no_list = #{deliverNoList, jdbcType=VARCHAR},</if>
			<if test="deliverNameList != null"> AND deliver_name_list = #{deliverNameList, jdbcType=VARCHAR},</if>
			<if test="isCloseCalc != null"> AND is_close_calc = #{isCloseCalc, jdbcType=BIT},</if>
			<if test="orderRemark != null"> AND order_remark = #{orderRemark, jdbcType=VARCHAR},</if>
			<if test="isDelate != null"> AND is_delate = #{isDelate, jdbcType=BIT},</if>
			<if test="createTime != null"> AND create_time = #{createTime, jdbcType=DATETIME},</if>
			<if test="creator != null"> AND creator = #{creator, jdbcType=VARCHAR},</if>
			<if test="lastUpdateTime != null"> AND last_update_time = #{lastUpdateTime, jdbcType=DATETIME},</if>
			<if test="lastUpdator != null"> AND last_updator = #{lastUpdator, jdbcType=VARCHAR},</if>
		) b where a.order_id = b.order_id
	</select>

	<!-- 更新，通用方法 -->
	<update id="updateOrderByOrderId" parameterType="map">
		update dt_order
		<include refid="UpdateSetColumns"/>
		where order_id = #{orderId, jdbcType=BIGINT}
	</update>

</mapper>
